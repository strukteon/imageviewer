{"version":3,"file":"imageviewer.bundle.js","sources":["../src/imageviewer.js"],"sourcesContent":["const imageviewer = {\n    elems: null,\n    __imageContainerElem: null,\n    __imageviewerElem: null,\n    __btnEventListeners: null,\n    __isLoading: false,\n    __curImgElem: null,\n    __spinnerElem: null,\n    __curIndex: null,\n\n    __injectIntoDom: function () {\n        document.body.insertAdjacentHTML(\"beforeend\", `\n            <div id=\"imageviewer\" class=\"imageviewer\">\n                <div class=\"imageviewer__background\"></div>\n                <div class=\"imageviewer__controls\">\n                    <div class=\"imageviewer__close\"><i class=\"fa-solid fa-xmark\"></i></div>\n                    <div class=\"imageviewer__arrows\">\n                        <div class=\"imageviewer__prev\"><i class=\"fa-solid fa-arrow-left\"></i></div>\n                        <div class=\"imageviewer__next\"><i class=\"fa-solid fa-arrow-right\"></i></div>\n                    </div>\n                </div>\n                <div class=\"imageviewer__container\">\n                    <img class=\"imageviewer__image__previous\" src=\"https://placehold.co/600x400\">\n                    <img class=\"imageviewer__image__current\" src=\"https://placehold.co/600x400\">\n                    <div class=\"spinner-container\">\n                        <i class=\"spinner fa-solid fa-spinner fa-spin-pulse\"></i>\n                    </div>\n                    <img class=\"imageviewer__image__next\" src=\"https://placehold.co/600x400\">\n                </div>\n            </div>\n        `);\n\n        this.__imageviewerElem = document.getElementById(\"imageviewer\");\n        this.__imageContainerElem = this.__imageviewerElem.querySelector(\".imageviewer__container\");\n        document.querySelector(\".imageviewer__close\").addEventListener(\"click\", this.__hideImage.bind(this));\n\n        this.elems = [...document.querySelectorAll(\"[data-viewableimage]\")];\n\n        this.eventListeners = this.elems.map((elem, index) => {\n            elem.addEventListener(\"click\", (event) => {\n                event.preventDefault();\n                this.__showImage(index);\n                this.__curIndex = index;\n            });\n        });\n\n        this.__curImgElem = this.__imageviewerElem.querySelector(\".imageviewer__image__current\");\n        this.__curImgElem.addEventListener(\"load\", () => {\n            this.__curImgElem.style.display = null;\n            this.__imageviewerElem.querySelector(\".spinner-container\").style.display = \"none\";\n            this.__isLoading = false;\n        });\n\n        this.__spinnerElem = this.__imageviewerElem.querySelector(\".spinner-container\");\n\n        this.__imageviewerElem.querySelector(\".imageviewer__prev\").addEventListener(\"click\", () => this.__prevImage.bind(this)());\n        this.__imageviewerElem.querySelector(\".imageviewer__next\").addEventListener(\"click\", () => this.__nextImage.bind(this)());\n    },\n\n    init: function () {\n        if (this.__imageviewerElem === null) {\n            this.__injectIntoDom();\n            this.__addEventListeners();\n        }\n    },\n\n    __addEventListeners: function () {\n        window.addEventListener(\"keydown\", (event) => {\n            if (!this.__imageviewerElem.classList.contains(\"imageviewer__visible\")) {\n                return;\n            }\n            if (event.key === \"Escape\") {\n                this.__hideImage();\n            } else if (event.key === \"ArrowLeft\") {\n                this.__prevImage();\n            } else if (event.key === \"ArrowRight\") {\n                this.__nextImage();\n            }\n        });\n    },\n\n    __getElemData: function (elem) {\n        let src = elem.getAttribute(\"src\");\n        if (elem.hasAttribute(\"data-viewableimage-src\")) {\n            src = elem.getAttribute(\"data-viewableimage-src\");\n        }\n        const alt = elem.getAttribute(\"alt\");\n        const title = elem.getAttribute(\"title\");\n        return {src, alt, title};\n    },\n\n    __showImage: function (index, prevIndexOffset = 0) {\n        const elem = this.elems[index];\n        if (!elem || this.__isLoading) {\n            return;\n        }\n        this.__curIndex = index;\n        this.__imageContainerElem.classList.remove(\"animate-previous-image\", \"animate-next-image\");\n\n        requestAnimationFrame(() => {\n            if (prevIndexOffset === 0 || ! this.elems[index - prevIndexOffset]) {\n                return;\n            }\n            if (prevIndexOffset === 1) {\n                this.__imageviewerElem.querySelector(\".imageviewer__image__previous\").src = this.__getElemData(this.elems[index - prevIndexOffset]).src;\n                this.__imageContainerElem.classList.add(\"animate-next-image\");\n            } else {\n                this.__imageviewerElem.querySelector(\".imageviewer__image__next\").src = this.__getElemData(this.elems[index - prevIndexOffset]).src;\n                this.__imageContainerElem.classList.add(\"animate-previous-image\");\n            }\n        });\n\n        this.__imageviewerElem.classList.add(\"imageviewer__visible\");\n        document.body.classList.add(\"no-scroll\");\n\n        this.__curImgElem.style.display = \"none\";\n        this.__spinnerElem.style.display = null;\n        const {src, alt, title} = this.__getElemData(elem);\n        this.__curImgElem.src = src;\n        this.__isLoading = true;\n        this.__curImgElem.alt = alt;\n        this.__curImgElem.title = title;\n\n        const btnPrev = this.__imageviewerElem.querySelector(\".imageviewer__prev\");\n        const btnNext = this.__imageviewerElem.querySelector(\".imageviewer__next\");\n        if (index > 0) {\n            btnPrev.classList.remove(\"disabled\");\n        } else {\n            btnPrev.classList.add(\"disabled\");\n        }\n\n        if (index < this.elems.length - 1) {\n            btnNext.classList.remove(\"disabled\");\n        } else {\n            btnNext.classList.add(\"disabled\");\n        }\n    },\n\n    __nextImage() {\n        this.__showImage(this.__curIndex + 1, 1);\n    },\n\n    __prevImage() {\n        this.__showImage(this.__curIndex - 1, -1);\n    },\n\n    __hideImage: function () {\n        this.__imageviewerElem.classList.remove(\"imageviewer__visible\");\n        document.body.classList.remove(\"no-scroll\");\n    },\n\n}\nimageviewer.init();\nwindow.imageviewer = imageviewer;"],"names":["imageviewer","elems","__imageContainerElem","__imageviewerElem","__btnEventListeners","__isLoading","__curImgElem","__spinnerElem","__curIndex","__injectIntoDom","document","body","insertAdjacentHTML","this","getElementById","querySelector","addEventListener","__hideImage","bind","querySelectorAll","eventListeners","map","elem","index","event","preventDefault","__showImage","style","display","__prevImage","__nextImage","init","__addEventListeners","window","classList","contains","key","__getElemData","src","getAttribute","hasAttribute","alt","title","prevIndexOffset","remove","requestAnimationFrame","add","btnPrev","btnNext","length"],"mappings":"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"}